import"./source-map-generator-CYV46cXA.min.js";import"./dist-gE_XXzPp.min.js";import{Ct as Q,Gt as q,O as Le,Qt as T,S as y,St as W,Tt as U,X as _,Xt as S,b as Ae,er as qe,gt as m,ir as B,jn as I,k as E,rr as V,rt as We,s as D,u as Ve,ut as J,wt as De,x as O,xn as $,y as w}from"./runtime-core.esm-bundler-DRZAYnQ2.min.js";import{n as Oe,r as ze,s as Me}from"./vue.runtime.esm-bundler-BlWQ9Hv9.min.js";import"./dist-CyCkKGye.min.js";import"./log-BpAY2Wg4.js";import"./chunk-HTB5LLOP-BErhSb2z.min.js";import{f as je}from"./core-8AzxaLAT.min.js";import"./floating-ui.core-BwRAMOlv.min.js";import"./api-j1hi8yn9.js";import"./index.browser-DQZXIZaU.min.js";import"./isObject-DkMBgCmn.min.js";import"./_toKey-lf-76zFF.min.js";import{t as Fe}from"./set-D10waSiW.min.js";import"./get-CMyps7rf.min.js";import"./virtualRef-CZBazqxr.js";import"./preload-helper-hRiy8xQv.min.js";import"./base64-F91Q3Zd1.min.js";import"./lib-DdqEuSaZ.min.js";import"./dist-7RENR6RM.min.js";import"./path-browserify-QbCHt7ci.min.js";import"./pre-process-DdabCSb9.js";import{__tla as Re}from"./cssesc-CRBmtthf.js";import{__tla as Ue}from"./lightningcss-wasm-Dq7A3rEr.min.js";import"./build-CCjEc_ld.js";import{t as Be}from"./vfs-Nkm45dX9.js";import{c as Xe,i as He}from"./intellisense-Dz5eHkgp.js";import"./adobe-css-tools-Cq8Zs2rG.min.js";import"./dlv.umd-ByGaGM3P.min.js";import{__tla as Ne}from"./tailwindcss-D1kdoqZn.js";import{t as z}from"./logger-B3j_KY2M.js";import{t as P}from"./_plugin-vue_export-helper-89dl49sx.min.js";import{a as Ke,i as Ye,n as Ge,r as Qe,t as Je}from"./chevron-right-iAp4ISoK.min.js";import{n as X,r as Ze,t as Z}from"./constant-BwtmMKdP.js";Promise.all([(()=>{try{return Re}catch{}})(),(()=>{try{return Ue}catch{}})(),(()=>{try{return Ne}catch{}})()]).then(async()=>{var ee={id:"windpressbricks-variable-app-header",class:"header-container"},te={class:"header-content"},re={class:"header-logo"},ae={class:"header-title"},le=P({__name:"PanelHeader",setup(a){let t=_("variableApp"),r=_("isOpen");function f(){let s=t.querySelector("#windpressbricks-variable-app-header"),d=$(!1),g=0,v=0;q(d,n=>{n?(document.body.style.userSelect="none",Z.style.pointerEvents="none",s.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),Z.style.removeProperty("pointer-events"),s.style.cursor="grab")});let i=n=>{d.value=!0;let l=s.getBoundingClientRect();g=n.clientX-l.left,v=n.clientY-l.top};s.removeEventListener("mousedown",i),s.addEventListener("mousedown",i);let c=n=>{if(!d.value)return;let l=s.getBoundingClientRect(),u=n.clientX,e=n.clientY,o=u-g,p=e-v,k=o<0?0:o>window.innerWidth-l.width?window.innerWidth-l.width:o,h=p<0?0:p>window.innerHeight-l.height?window.innerHeight-l.height:p;t.style.left=`${k}px`,t.style.top=`${h}px`};document.removeEventListener("mousemove",c),document.addEventListener("mousemove",c);let b=n=>{d.value=!1};document.removeEventListener("mouseup",b),document.addEventListener("mouseup",b)}return J(()=>{f()}),(s,d)=>{let g=De("inline-svg"),v=Qe,i=U("tooltip");return m(),y("div",ee,[w("div",te,[w("div",re,[E(g,{src:I(Ge),class:"inline-svg"},null,8,["src"])]),T((m(),y("div",ae,[...d[1]||(d[1]=[Le(" WindPress ",-1)])])),[[i,{placement:"top",content:`v${s.windpressbricks._version}`}]]),T((m(),y("button",{class:"header-exit",onClick:d[0]||(d[0]=c=>r.value=!I(r))},[E(v,{class:"iconify"})])),[[i,{placement:"top",content:"Close"}]])])])}}},[["__scopeId","data-v-97f7f622"]]),oe={class:"header-slot"},ne={key:0,class:"expansion-panel__body"},ie={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(a,{expose:t}){let r=a,f=$(null),s=je(`windpressbricks-variable-app.ui.expansion-panels.${r.namespace}`,{[`${r.name}`]:!1},void 0,{mergeDefaults:!0});function d(v){s.value[r.name]=v===null?!s.value[r.name]:v}function g(){f.value.scrollIntoView()}return t({togglePanel:d,scrollIntoView:g}),(v,i)=>{let c=Je;return m(),y("div",{ref_key:"sectionRef",ref:f,class:"expansion-panel"},[w("div",{class:qe([{},"expansion-panel__header"]),onClick:i[0]||(i[0]=b=>I(s)[a.name]=!I(s)[a.name])},[w("div",oe,[Q(v.$slots,"header",{},void 0,!0)]),w("div",null,[E(c,{style:V({transform:I(s)[a.name]?"rotate(-90deg)":"rotate(0deg)"}),class:"iconify"},null,8,["style"])])]),E(Oe,null,{default:S(()=>[I(s)[a.name]?(m(),y("div",ne,[Q(v.$slots,"default",{},void 0,!0)])):O("",!0)]),_:3})],512)}}},M=P(ie,[["__scopeId","data-v-48d9357f"]]),se={class:"{m:10;pb:15}>div"},ce={class:"variable-section-title font:14 my:10"},ue={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},pe=["onClick","onMouseenter"],de={class:"font:14"},ve=1e3,me={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(a){let t=_("focusedInput"),r=_("recentVariableSelectionTimestamp"),f=_("tempInputValue");function s(v,i){performance.now()-r.value<ve||t.value&&(t.value.value=`var(${i})`,t.value.dispatchEvent(new Event("input")),t.value.focus())}function d(v){!t.value||f.value===null||(t.value.value=f.value,t.value.dispatchEvent(new Event("input")),t.value.focus())}function g(v,i){t.value&&(t.value.value=`var(${i})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),f.value=`var(${i})`,r.value=performance.now())}return(v,i)=>{let c=U("tooltip");return m(),y("div",se,[(m(!0),y(D,null,W(a.variableItems,(b,n)=>(m(),y("div",{key:n,class:"var-item"},[w("div",ce,B(n.replace("_","-")),1),w("div",ue,[b.length>0?(m(!0),y(D,{key:0},W(b,(l,u)=>T((m(),y("button",{key:u,class:"px:12 py:8 r:$(builder-border-radius) fg:$(builder-color) bg:$(builder-bg-2) bg:$(builder-bg-3):hover b:0 flex-grow:1 flex-shrink:1 flex-basis:30% text:center {opacity:.5;font:semibold}>span opacity:100:hover>span",onClick:e=>g(e,l.key),onMouseenter:e=>s(e,l.key),onMouseleave:d},[w("span",de,B(l.label),1)],40,pe)),[[c,{placement:"top",content:`var(${l.key}, ${l.value})`}]])),128)):O("",!0)])]))),128))])}}},H=P(me,[["__scopeId","data-v-ecbe9380"]]);function j(){var t,r;if(X.$_state.activePanel!=="element")return null;let a=(t=X.$_state)==null?void 0:t.activeElement.id;return(r=X.$_getIframeDoc())==null?void 0:r.getElementById(`brxe-${a}`)}function ye({selector:a,callback:t,options:r}){let f=new MutationObserver(t),s=document.querySelector(a);if(!s){z(`Target not found for selector: ${a}`,{module:"variable-picker",type:"error"});return}f.observe(s,Object.assign(Object.assign({},{childList:!0,subtree:!0}),r))}var be={class:"{m:10;pb:15}>div"},fe={class:"variable-section-title"},ge={key:0,class:"variable-section-items default-color"},ke=["onClick","onMouseenter"],he=["onClick","onMouseenter"],we=1e3,_e={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(a){let t=_("focusedInput"),r=_("recentColorPickerTarget"),f=_("recentVariableSelectionTimestamp"),s=_("tempInputValue");function d(n,l){var u;if(!(performance.now()-f.value<we)){if(!t.value){let e=j();if(!e)return;for(let{property:o,control:p}of[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}])(u=r.value)!=null&&u.closest(`[data-control="${p}"]`)&&(e.style[o]=`var(${l})`);return}t.value.value=`var(${l})`,t.value.dispatchEvent(new Event("input")),t.value.focus()}}function g(n){var l;if(!t.value||s.value===null){let u=j();if(!u)return;for(let{property:e,control:o}of[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}])(l=r.value)!=null&&l.closest(`[data-control="${o}"]`)&&(u.style[e]="");return}t.value.value=s.value,t.value.dispatchEvent(new Event("input")),t.value.focus()}function v(n,l){if(n.stopPropagation(),n.preventDefault(),!t.value){let u=r.value;b(l),f.value=performance.now(),setTimeout(()=>{let e=j();if(e)for(let{property:o,control:p}of[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}])u!=null&&u.closest(`[data-control="${p}"]`)&&(e.style[o]="")},5);return}t.value.value=`var(${l})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),s.value=`var(${l})`,f.value=performance.now()}function i(){document.querySelectorAll(".windpressbricks-variable-app-colorpopup").forEach(n=>{n.remove()})}function c(){if(document.querySelector(".windpressbricks-variable-app-colorpopup"))return;let n=document.createElement("style");n.id="windpressbricks-variable-app-bricks-popup",n.appendChild(document.createTextNode(".bricks-control-popup { display: none !important; }")),n.classList.add("windpressbricks-variable-app-colorpopup"),document.head.appendChild(n)}async function b(n){var u,e,o,p,k;c(),document.querySelector(".bricks-control-popup .color-palette.grid")||((e=(u=r.value)==null?void 0:u.closest(".bricks-control-preview"))==null||e.click(),await new Promise(h=>setTimeout(h,25)));let l=document.querySelector(".bricks-control-popup .color-palette.grid");l?(p=(o=l.querySelector(`[data-balloon="var(${n})"]`))==null?void 0:o.parentElement)==null||p.click():z("Failed to select color. Color grid not found.",{module:"variable-picker",type:"error"}),(k=document.querySelector("body"))==null||k.click(),await new Promise(h=>setTimeout(h,2)),document.querySelector(".bricks-control-popup")?(setTimeout(()=>{var h;(h=document.querySelector("body"))==null||h.click(),setTimeout(()=>{i()},5)},5),z("Failed to close color picker. Delaying close.",{module:"variable-picker",type:"error"})):i()}return(n,l)=>{let u=U("tooltip");return m(),y("div",be,[(m(!0),y(D,null,W(a.variableItems,(e,o)=>(m(),y("div",{key:o,class:""},[w("div",fe,B(o),1),e.DEFAULT?(m(),y("div",ge,[T(w("button",{style:V(`--wp-b-v-item-bg: var(--${e.DEFAULT.key.slice(2)});`),class:"",onClick:p=>v(p,e.DEFAULT.key),onMouseenter:p=>d(p,e.DEFAULT.key),onMouseleave:g},null,44,ke),[[u,{placement:"top",content:`var(${e.DEFAULT.key}, ${e.DEFAULT.value})`}]])])):O("",!0),e.shades&&Object.keys(e.shades).length>0?(m(),y("div",{key:1,style:V(`--wp-b-v-items-grid: ${Object.keys(e.shades).length}`),class:"variable-section-items shades-colors"},[(m(!0),y(D,null,W(e.shades,(p,k)=>(m(),y("div",{key:k,class:""},[T(w("button",{style:V(`--wp-b-v-item-bg: var(--${p.key.slice(2)})`),onClick:h=>v(h,p.key),onMouseenter:h=>d(h,p.key),onMouseleave:g},null,44,he),[[u,{placement:"top",content:`var(${p.key}, ${p.value})`}]])]))),128))],4)):O("",!0)]))),128))])}}},Ee=P(_e,[["__scopeId","data-v-c22ad97c"]]),$e={id:"windpressbricks-variable-app-body",class:"var-body"},Ce=P({__name:"PanelBody",setup(a){let t=$({colors:{},typography:{},sizing:{}}),r=_("focusedInput"),f=_("recentColorPickerTarget");async function s(){let i=Ze.contentWindow.document.querySelector('script#windpress\\:vfs[type="text/plain"]'),c=Be(i.textContent),b=await He(await Xe({volume:c})),n={};b.filter(e=>e.key.startsWith("--color")).forEach(e=>{let o=e.key.slice(8),p=o.split("-"),k="";if(p.length>1){let h=p[0],Pe=p.slice(1).join("-");k=`${h}.shades.'${Pe}'`}else k=`${o}.DEFAULT`;Fe(n,k,e)}),t.value.colors=Object.keys(n).sort().reduce((e,o)=>(e[o]=n[o],e),{});let l={font_size:[],line_height:[],letter_spacing:[]};b.filter(e=>e.key.startsWith("--text-")&&!e.key.endsWith("--line-height")).forEach(e=>{let o=e.key.slice(7);l.font_size.push({key:e.key,label:o,value:e.value})}),b.filter(e=>e.key.startsWith("--leading-")||e.key.endsWith("--leading")).forEach(e=>{let o=e.key.startsWith("--leading-")?e.key.slice(10):e.key.slice(2,-9);l.line_height.push({key:e.key,label:o,value:e.value})}),l.line_height.sort((e,o)=>e.label.startsWith("font-size-")&&!o.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&o.label.startsWith("font-size-")?-1:0),b.filter(e=>e.key.startsWith("--tracking-")).forEach(e=>{let o=e.key.slice(11);l.letter_spacing.push({key:e.key,label:o,value:e.value})}),t.value.typography=l;let u={container:[],breakpoint:[]};b.filter(e=>e.key.startsWith("--container-")).forEach(e=>{let o=e.key.slice(12);u.container.push({key:e.key,label:o,value:e.value})}),b.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{let o=e.key.slice(13);u.breakpoint.push({key:e.key,label:o,value:e.value})}),t.value.sizing=u}let d=$(null),g=$(null),v=$(null);return q(r,i=>{var c,b,n,l;if(i){let u=((b=(c=i.closest("[data-controlkey]"))==null?void 0:c.dataset.controlkey)==null?void 0:b.toLocaleLowerCase())??"",e=["typography","font"].some(k=>u.includes(k)),o=["padding","margin","gap","width","height"].some(k=>u.includes(k)),p=(l=(n=i.parentElement)==null?void 0:n.parentElement)==null?void 0:l.classList.contains("color-input");g.value.togglePanel(!1),v.value.togglePanel(!1),d.value.togglePanel(!1),p?(d.value.togglePanel(!0),d.value.scrollIntoView()):e?(g.value.togglePanel(!0),g.value.scrollIntoView()):o&&(v.value.togglePanel(!0),v.value.scrollIntoView())}}),q(f,i=>{i&&(d.value.togglePanel(!0),d.value.scrollIntoView())}),J(()=>{s()}),new BroadcastChannel("windpress").addEventListener("message",async i=>{let c=i.data;c.source==="windpress/intellisense"&&c.task==="windpress.code-editor.saved.done"&&setTimeout(()=>{s()},1e3)}),(i,c)=>(m(),y("div",$e,[E(M,{ref_key:"sectionColor",ref:d,namespace:"variable",name:"color"},{header:S(()=>[...c[0]||(c[0]=[w("span",{class:"var-body-title"},"Color",-1)])]),default:S(()=>[E(Ee,{"variable-items":t.value.colors},null,8,["variable-items"])]),_:1},512),E(M,{ref_key:"sectionTypography",ref:g,namespace:"variable",name:"typography"},{header:S(()=>[...c[1]||(c[1]=[w("span",{class:"var-body-title"},"Typography",-1)])]),default:S(()=>[E(H,{"variable-items":t.value.typography},null,8,["variable-items"])]),_:1},512),E(M,{ref_key:"sectionSpacing",ref:v,namespace:"variable",name:"spacing",class:""},{header:S(()=>[...c[2]||(c[2]=[w("span",{class:"var-body-title"},"Sizing",-1)])]),default:S(()=>[E(H,{"variable-items":t.value.sizing},null,8,["variable-items"])]),_:1},512)]))}},[["__scopeId","data-v-cb1fc473"]]),Se={id:"windpressbricks-variable-app-container",class:"wp-b-var-container"},Ie=P({__name:"App",setup(a){let t=_("isOpen");return(r,f)=>T((m(),y("div",Se,[E(le),(m(),Ae(Ve,null,{default:S(()=>[E(Ce)]),_:1}))],512)),[[Me,I(t)]])}},[["__scopeId","data-v-8a9882a1"]]),L=document.createElement("windpressbricks-variable-app");L.id="windpressbricks-variable-app",document.body.appendChild(L);var x=$(!1),A=$(null),N=$(null),F=$(null),xe=$(0),C=ze(Ie);C.config.globalProperties.windpressbricks=window.windpressbricks,C.provide("variableApp",L),C.provide("isOpen",x),C.provide("focusedInput",A),C.provide("tempInputValue",N),C.provide("recentColorPickerTarget",F),C.provide("recentVariableSelectionTimestamp",xe),C.use(Ye,{container:"#windpressbricks-variable-app"}),C.component("InlineSvg",Ke),C.mount("#windpressbricks-variable-app");function K(a){var t;!a.shiftKey||!a.target||((t=document==null?void 0:document.getSelection())==null||t.removeAllRanges(),a.preventDefault(),a.stopPropagation(),A.value=a.target,N.value=a.target.value,x.value=!0)}function Y(a){A.value=a.target}var Te=['div[data-control="number"]',{selector:'div[data-control="text"]',hasChild:["#_flexBasis","#_overflow","#_gridTemplateColumns","#_gridTemplateRows","#_gridAutoColumns","#_gridAutoRows","#_objectPosition",'[id^="raw-"]']}];function G(){setTimeout(()=>{Te.forEach(a=>{(typeof a=="string"?[...document.querySelectorAll(a)]:[...document.querySelectorAll(a.selector)].filter(t=>a.hasChild.some(r=>t.querySelector(r)))).forEach(t=>{let r=t.querySelector("input[type='text']");(r==null?void 0:r.getAttribute("windpressbricks-variable-app"))!=="listened"&&(r==null||r.removeEventListener("click",K),r==null||r.addEventListener("click",K),r==null||r.removeEventListener("focus",Y),r==null||r.addEventListener("focus",Y),r==null||r.setAttribute("windpressbricks-variable-app","listened"),r==null||r.parentNode.setAttribute("data-balloon","Shift + click to open the Variable Picker"),r==null||r.parentNode.setAttribute("data-balloon-pos","bottom-right"))})}),[...document.querySelectorAll(".bricks-control-preview")].filter(a=>{var t,r;return((r=(t=a.closest(".control-inner"))==null?void 0:t.querySelector("label"))==null?void 0:r.getAttribute("for"))==="color"}).forEach(a=>{a.addEventListener("contextmenu",t=>{var r;!t.shiftKey||!t.target||(t.preventDefault(),t.stopPropagation(),(r=document==null?void 0:document.getSelection())==null||r.removeAllRanges(),A.value=null,x.value=!0,F.value=null,We(()=>{F.value=t.target}))})})},100)}var R=!1;ye({selector:"#bricks-panel-inner",options:{subtree:!0,childList:!0},callback(){R||(R=!0,G(),setTimeout(()=>{R=!1},100))}}),G(),document.addEventListener("keydown",a=>{a.key==="Escape"&&x.value&&(x.value=!1)}),q(x,a=>{L.style.zIndex=a?"calc(Infinity)":"-1"}),z("Module loaded!",{module:"variable-picker"})});
