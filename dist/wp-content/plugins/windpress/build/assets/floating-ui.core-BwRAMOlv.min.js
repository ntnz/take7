var X=["top","right","bottom","left"],Y=["start","end"],Z=X.reduce((t,e)=>t.concat(e,e+"-"+Y[0],e+"-"+Y[1]),[]),W=Math.min,z=Math.max,st=Math.round,ft=Math.floor,ct=t=>({x:t,y:t}),mt={left:"right",right:"left",bottom:"top",top:"bottom"},ut={start:"end",end:"start"};function G(t,e,o){return z(t,W(e,o))}function B(t,e){return typeof t=="function"?t(e):t}function L(t){return t.split("-")[0]}function S(t){return t.split("-")[1]}function K(t){return t==="x"?"y":"x"}function U(t){return t==="y"?"height":"width"}var dt=new Set(["top","bottom"]);function H(t){return dt.has(L(t))?"y":"x"}function J(t){return K(H(t))}function $(t,e,o){o===void 0&&(o=!1);let n=S(t),a=J(t),l=U(a),r=a==="x"?n===(o?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[l]>e.floating[l]&&(r=q(r)),[r,q(r)]}function gt(t){let e=q(t);return[N(t),e,N(e)]}function N(t){return t.replace(/start|end/g,e=>ut[e])}var tt=["left","right"],et=["right","left"],pt=["top","bottom"],ht=["bottom","top"];function yt(t,e,o){switch(t){case"top":case"bottom":return o?e?et:tt:e?tt:et;case"left":case"right":return e?pt:ht;default:return[]}}function wt(t,e,o,n){let a=S(t),l=yt(L(t),o==="start",n);return a&&(l=l.map(r=>r+"-"+a),e&&(l=l.concat(l.map(N)))),l}function q(t){return t.replace(/left|right|bottom|top/g,e=>mt[e])}function xt(t){return{top:0,right:0,bottom:0,left:0,...t}}function nt(t){return typeof t=="number"?{top:t,right:t,bottom:t,left:t}:xt(t)}function Q(t){let{x:e,y:o,width:n,height:a}=t;return{width:n,height:a,top:o,left:e,right:e+n,bottom:o+a,x:e,y:o}}function at(t,e,o){let{reference:n,floating:a}=t,l=H(e),r=J(e),d=U(r),x=L(e),g=l==="y",s=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,m=n[d]/2-a[d]/2,i;switch(x){case"top":i={x:s,y:n.y-a.height};break;case"bottom":i={x:s,y:n.y+n.height};break;case"right":i={x:n.x+n.width,y:f};break;case"left":i={x:n.x-a.width,y:f};break;default:i={x:n.x,y:n.y}}switch(S(e)){case"start":i[r]-=m*(o&&g?-1:1);break;case"end":i[r]+=m*(o&&g?-1:1);break}return i}var vt=async(t,e,o)=>{let{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:r}=o,d=l.filter(Boolean),x=await(r.isRTL==null?void 0:r.isRTL(e)),g=await r.getElementRects({reference:t,floating:e,strategy:a}),{x:s,y:f}=at(g,n,x),m=n,i={},c=0;for(let u=0;u<d.length;u++){let{name:p,fn:y}=d[u],{x:w,y:h,data:A,reset:v}=await y({x:s,y:f,initialPlacement:n,placement:m,strategy:a,middlewareData:i,rects:g,platform:r,elements:{reference:t,floating:e}});s=w??s,f=h??f,i={...i,[p]:{...i[p],...A}},v&&c<=50&&(c++,typeof v=="object"&&(v.placement&&(m=v.placement),v.rects&&(g=v.rects===!0?await r.getElementRects({reference:t,floating:e,strategy:a}):v.rects),{x:s,y:f}=at(g,m,x)),u=-1)}return{x:s,y:f,placement:m,strategy:a,middlewareData:i}};async function I(t,e){e===void 0&&(e={});let{x:o,y:n,platform:a,rects:l,elements:r,strategy:d}=t,{boundary:x="clippingAncestors",rootBoundary:g="viewport",elementContext:s="floating",altBoundary:f=!1,padding:m=0}=B(e,t),i=nt(m),c=r[f?s==="floating"?"reference":"floating":s],u=Q(await a.getClippingRect({element:await(a.isElement==null?void 0:a.isElement(c))??!0?c:c.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(r.floating)),boundary:x,rootBoundary:g,strategy:d})),p=s==="floating"?{x:o,y:n,width:l.floating.width,height:l.floating.height}:l.reference,y=await(a.getOffsetParent==null?void 0:a.getOffsetParent(r.floating)),w=await(a.isElement==null?void 0:a.isElement(y))&&await(a.getScale==null?void 0:a.getScale(y))||{x:1,y:1},h=Q(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:r,rect:p,offsetParent:y,strategy:d}):p);return{top:(u.top-h.top+i.top)/w.y,bottom:(h.bottom-u.bottom+i.bottom)/w.y,left:(u.left-h.left+i.left)/w.x,right:(h.right-u.right+i.right)/w.x}}var bt=t=>({name:"arrow",options:t,async fn(e){let{x:o,y:n,placement:a,rects:l,platform:r,elements:d,middlewareData:x}=e,{element:g,padding:s=0}=B(t,e)||{};if(g==null)return{};let f=nt(s),m={x:o,y:n},i=J(a),c=U(i),u=await r.getDimensions(g),p=i==="y",y=p?"top":"left",w=p?"bottom":"right",h=p?"clientHeight":"clientWidth",A=l.reference[c]+l.reference[i]-m[i]-l.floating[c],v=m[i]-l.reference[i],T=await(r.getOffsetParent==null?void 0:r.getOffsetParent(g)),R=T?T[h]:0;(!R||!await(r.isElement==null?void 0:r.isElement(T)))&&(R=d.floating[h]||l.floating[c]);let E=A/2-v/2,b=R/2-u[c]/2-1,P=W(f[y],b),C=W(f[w],b),O=P,j=R-u[c]-C,D=R/2-u[c]/2+E,V=G(O,D,j),M=!x.arrow&&S(a)!=null&&D!==V&&l.reference[c]/2-(D<O?P:C)-u[c]/2<0,k=M?D<O?D-O:D-j:0;return{[i]:m[i]+k,data:{[i]:V,centerOffset:D-V-k,...M&&{alignmentOffset:k}},reset:M}}});function At(t,e,o){return(t?[...o.filter(n=>S(n)===t),...o.filter(n=>S(n)!==t)]:o.filter(n=>L(n)===n)).filter(n=>t?S(n)===t||(e?N(n)!==n:!1):!0)}var Rt=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var T,R,E;let{rects:o,middlewareData:n,placement:a,platform:l,elements:r}=e,{crossAxis:d=!1,alignment:x,allowedPlacements:g=Z,autoAlignment:s=!0,...f}=B(t,e),m=x!==void 0||g===Z?At(x||null,s,g):g,i=await I(e,f),c=((T=n.autoPlacement)==null?void 0:T.index)||0,u=m[c];if(u==null)return{};let p=$(u,o,await(l.isRTL==null?void 0:l.isRTL(r.floating)));if(a!==u)return{reset:{placement:m[0]}};let y=[i[L(u)],i[p[0]],i[p[1]]],w=[...((R=n.autoPlacement)==null?void 0:R.overflows)||[],{placement:u,overflows:y}],h=m[c+1];if(h)return{data:{index:c+1,overflows:w},reset:{placement:h}};let A=w.map(b=>{let P=S(b.placement);return[b.placement,P&&d?b.overflows.slice(0,2).reduce((C,O)=>C+O,0):b.overflows[0],b.overflows]}).sort((b,P)=>b[1]-P[1]),v=((E=A.filter(b=>b[2].slice(0,S(b[0])?2:3).every(P=>P<=0))[0])==null?void 0:E[0])||A[0][0];return v===a?{}:{data:{index:c+1,overflows:w},reset:{placement:v}}}}},Dt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var P,C,O,j;var o;let{placement:n,middlewareData:a,rects:l,initialPlacement:r,platform:d,elements:x}=e,{mainAxis:g=!0,crossAxis:s=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:i="none",flipAlignment:c=!0,...u}=B(t,e);if((o=a.arrow)!=null&&o.alignmentOffset)return{};let p=L(n),y=H(r),w=L(r)===r,h=await(d.isRTL==null?void 0:d.isRTL(x.floating)),A=f||(w||!c?[q(r)]:gt(r)),v=i!=="none";!f&&v&&A.push(...wt(r,c,i,h));let T=[r,...A],R=await I(e,u),E=[],b=((P=a.flip)==null?void 0:P.overflows)||[];if(g&&E.push(R[p]),s){let D=$(n,l,h);E.push(R[D[0]],R[D[1]])}if(b=[...b,{placement:n,overflows:E}],!E.every(D=>D<=0)){let D=(((C=a.flip)==null?void 0:C.index)||0)+1,V=T[D];if(V&&(!(s==="alignment"&&y!==H(V))||b.every(k=>H(k.placement)===y?k.overflows[0]>0:!0)))return{data:{index:D,overflows:b},reset:{placement:V}};let M=(O=b.filter(k=>k.overflows[0]<=0).sort((k,_)=>k.overflows[1]-_.overflows[1])[0])==null?void 0:O.placement;if(!M)switch(m){case"bestFit":{let k=(j=b.filter(_=>{if(v){let F=H(_.placement);return F===y||F==="y"}return!0}).map(_=>[_.placement,_.overflows.filter(F=>F>0).reduce((F,ot)=>F+ot,0)]).sort((_,F)=>_[1]-F[1])[0])==null?void 0:j[0];k&&(M=k);break}case"initialPlacement":M=r;break}if(n!==M)return{reset:{placement:M}}}return{}}}};function rt(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function it(t){return X.some(e=>t[e]>=0)}var Pt=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){let{rects:o}=e,{strategy:n="referenceHidden",...a}=B(t,e);switch(n){case"referenceHidden":{let l=await I(e,{...a,elementContext:"reference"}),r=rt(l,o.reference);return{data:{referenceHiddenOffsets:r,referenceHidden:it(r)}}}case"escaped":{let l=await I(e,{...a,altBoundary:!0}),r=rt(l,o.floating);return{data:{escapedOffsets:r,escaped:it(r)}}}default:return{}}}}},lt=new Set(["left","top"]);async function Tt(t,e){let{placement:o,platform:n,elements:a}=t,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),r=L(o),d=S(o),x=H(o)==="y",g=lt.has(r)?-1:1,s=l&&x?-1:1,f=B(e,t),{mainAxis:m,crossAxis:i,alignmentAxis:c}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return d&&typeof c=="number"&&(i=d==="end"?c*-1:c),x?{x:i*s,y:m*g}:{x:m*g,y:i*s}}var Et=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var x;var o;let{x:n,y:a,placement:l,middlewareData:r}=e,d=await Tt(e,t);return l===((x=r.offset)==null?void 0:x.placement)&&(o=r.arrow)!=null&&o.alignmentOffset?{}:{x:n+d.x,y:a+d.y,data:{...d,placement:l}}}}},kt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){let{x:o,y:n,placement:a}=e,{mainAxis:l=!0,crossAxis:r=!1,limiter:d={fn:p=>{let{x:y,y:w}=p;return{x:y,y:w}}},...x}=B(t,e),g={x:o,y:n},s=await I(e,x),f=H(L(a)),m=K(f),i=g[m],c=g[f];if(l){let p=m==="y"?"top":"left",y=m==="y"?"bottom":"right",w=i+s[p],h=i-s[y];i=G(w,i,h)}if(r){let p=f==="y"?"top":"left",y=f==="y"?"bottom":"right",w=c+s[p],h=c-s[y];c=G(w,c,h)}let u=d.fn({...e,[m]:i,[f]:c});return{...u,data:{x:u.x-o,y:u.y-n,enabled:{[m]:l,[f]:r}}}}}},Ot=function(t){return t===void 0&&(t={}),{options:t,fn(e){var y,w;let{x:o,y:n,placement:a,rects:l,middlewareData:r}=e,{offset:d=0,mainAxis:x=!0,crossAxis:g=!0}=B(t,e),s={x:o,y:n},f=H(a),m=K(f),i=s[m],c=s[f],u=B(d,e),p=typeof u=="number"?{mainAxis:u,crossAxis:0}:{mainAxis:0,crossAxis:0,...u};if(x){let h=m==="y"?"height":"width",A=l.reference[m]-l.floating[h]+p.mainAxis,v=l.reference[m]+l.reference[h]-p.mainAxis;i<A?i=A:i>v&&(i=v)}if(g){let h=m==="y"?"width":"height",A=lt.has(L(a)),v=l.reference[f]-l.floating[h]+(A&&((y=r.offset)==null?void 0:y[f])||0)+(A?0:p.crossAxis),T=l.reference[f]+l.reference[h]+(A?0:((w=r.offset)==null?void 0:w[f])||0)-(A?p.crossAxis:0);c<v?c=v:c>T&&(c=T)}return{[m]:i,[f]:c}}}},Lt=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var o,n;let{placement:a,rects:l,platform:r,elements:d}=e,{apply:x=()=>{},...g}=B(t,e),s=await I(e,g),f=L(a),m=S(a),i=H(a)==="y",{width:c,height:u}=l.floating,p,y;f==="top"||f==="bottom"?(p=f,y=m===(await(r.isRTL==null?void 0:r.isRTL(d.floating))?"start":"end")?"left":"right"):(y=f,p=m==="end"?"top":"bottom");let w=u-s.top-s.bottom,h=c-s.left-s.right,A=W(u-s[p],w),v=W(c-s[y],h),T=!e.middlewareData.shift,R=A,E=v;if((o=e.middlewareData.shift)!=null&&o.enabled.x&&(E=h),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(R=w),T&&!m){let P=z(s.left,0),C=z(s.right,0),O=z(s.top,0),j=z(s.bottom,0);i?E=c-2*(P!==0||C!==0?P+C:z(s.left,s.right)):R=u-2*(O!==0||j!==0?O+j:z(s.top,s.bottom))}await x({...e,availableWidth:E,availableHeight:R});let b=await r.getDimensions(d.floating);return c!==b.width||u!==b.height?{reset:{rects:!0}}:{}}}};export{Pt as a,kt as c,ft as d,z as f,st as h,Dt as i,Lt as l,Q as m,Rt as n,Ot as o,W as p,vt as r,Et as s,bt as t,ct as u};
