import{s as U}from"./chunk-BP1tGd43.min.js";import{E as Ri,Gt as W,O as V,Xt as g,b as I,gt as T,ir as P,j as Y,jn as re,k as F,u as Yi,v as Ni,xn as x,y as p,yn as ne}from"./runtime-core.esm-bundler-DRZAYnQ2.min.js";import{t as N}from"./Button-DgwZaK7A.min.js";import{i as te}from"./log-BpAY2Wg4.js";import{f as $i,n as Mi,s as Ui}from"./core-8AzxaLAT.min.js";import{t as Wi}from"./useOverlay-HL-7cGpt.min.js";import{t as qi}from"./useToast-DGTAcHwR.min.js";import{t as $}from"./Modal-DIkGyv2s.min.js";import{t as se}from"./api-j1hi8yn9.js";import{n as Hi}from"./index.browser-DQZXIZaU.min.js";import{a as ae,i as le,n as oe,r as de,t as Ji}from"./settings-EuhnKFOO.js";import{a as ce,r as pe}from"./isObject-DkMBgCmn.min.js";import{o as Bi,r as Zi,u as ue}from"./_toKey-lf-76zFF.min.js";import{d as Gi,i as _e,m as fe,o as q}from"./_initCloneObject-7WDIrBbB.min.js";import{t as we}from"./Input-CwtauoHz.min.js";import{t as D}from"./preload-helper-hRiy8xQv.min.js";import{t as me}from"./dist-DHrCA_qW.min.js";import{t as Ki}from"./path-browserify-QbCHt7ci.min.js";import{n as Xi}from"./vfs-Nkm45dX9.js";import{n as Qi,t as er}from"./dist-DNqxA4Wq.min.js";import{t as ve}from"./dayjs.min-BAjIZEkX.min.js";import{t as he}from"./FormField-3McXbx6Q.min.js";let H,z,ye,ir=(async()=>{var be="__lodash_hash_undefined__";function ge(e){return this.__data__.set(e,be),this}var Ee=ge;function Pe(e){return this.__data__.has(e)}var Fe=Pe;function L(e){var i=-1,r=e==null?0:e.length;for(this.__data__=new Zi;++i<r;)this.add(e[i])}L.prototype.add=L.prototype.push=Ee,L.prototype.has=Fe;var Se=L;function Ce(e,i){for(var r=-1,s=e==null?0:e.length;++r<s;)if(i(e[r],r,e))return!0;return!1}var je=Ce;function Oe(e,i){return e.has(i)}var xe=Oe,ke=1,Ae=2;function Ve(e,i,r,s,t,n){var d=r&ke,a=e.length,o=i.length;if(a!=o&&!(d&&o>a))return!1;var c=n.get(e),m=n.get(i);if(c&&m)return c==i&&m==e;var w=-1,u=!0,b=r&Ae?new Se:void 0;for(n.set(e,i),n.set(i,e);++w<a;){var h=e[w],E=i[w];if(s)var j=d?s(E,h,w,i,e,n):s(h,E,w,e,i,n);if(j!==void 0){if(j)continue;u=!1;break}if(b){if(!je(i,function(O,l){if(!xe(b,l)&&(h===O||t(h,O,r,s,n)))return b.push(l)})){u=!1;break}}else if(!(h===E||t(h,E,r,s,n))){u=!1;break}}return n.delete(e),n.delete(i),u}var J=Ve;function Ie(e){var i=-1,r=Array(e.size);return e.forEach(function(s,t){r[++i]=[t,s]}),r}var Te=Ie;function De(e){var i=-1,r=Array(e.size);return e.forEach(function(s){r[++i]=s}),r}var ze=De,Le=1,Re=2,Ye="[object Boolean]",Ne="[object Date]",$e="[object Error]",Me="[object Map]",Ue="[object Number]",We="[object RegExp]",qe="[object Set]",He="[object String]",Je="[object Symbol]",Be="[object ArrayBuffer]",Ze="[object DataView]",B=ce?ce.prototype:void 0,M=B?B.valueOf:void 0;function Ge(e,i,r,s,t,n,d){switch(r){case Ze:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Be:return!(e.byteLength!=i.byteLength||!n(new _e(e),new _e(i)));case Ye:case Ne:case Ue:return Bi(+e,+i);case $e:return e.name==i.name&&e.message==i.message;case We:case He:return e==i+"";case Me:var a=Te;case qe:var o=s&Le;if(a||(a=ze),e.size!=i.size&&!o)return!1;var c=d.get(e);if(c)return c==i;s|=Re,d.set(e,i);var m=J(a(e),a(i),s,t,n,d);return d.delete(e),m;case Je:if(M)return M.call(e)==M.call(i)}return!1}var Ke=Ge,Xe=1,Qe=Object.prototype.hasOwnProperty;function ei(e,i,r,s,t,n){var d=r&Xe,a=le(e),o=a.length,c=le(i),m=c.length;if(o!=m&&!d)return!1;for(var w=o;w--;){var u=a[w];if(!(d?u in i:Qe.call(i,u)))return!1}var b=n.get(e),h=n.get(i);if(b&&h)return b==i&&h==e;var E=!0;n.set(e,i),n.set(i,e);for(var j=d;++w<o;){u=a[w];var O=e[u],l=i[u];if(s)var f=d?s(l,O,u,i,e,n):s(O,l,u,e,i,n);if(!(f===void 0?O===l||t(O,l,r,s,n):f)){E=!1;break}j||(j=u=="constructor")}if(E&&!j){var v=e.constructor,y=i.constructor;v!=y&&"constructor"in e&&"constructor"in i&&!(typeof v=="function"&&v instanceof v&&typeof y=="function"&&y instanceof y)&&(E=!1)}return n.delete(e),n.delete(i),E}var ii=ei,ri=1,Z="[object Arguments]",G="[object Array]",R="[object Object]",K=Object.prototype.hasOwnProperty;function ni(e,i,r,s,t,n){var d=ue(e),a=ue(i),o=d?G:de(e),c=a?G:de(i);o=o==Z?R:o,c=c==Z?R:c;var m=o==R,w=c==R,u=o==c;if(u&&fe(e)){if(!fe(i))return!1;d=!0,m=!1}if(u&&!m)return n||(n=new q),d||Gi(e)?J(e,i,r,s,t,n):Ke(e,i,o,r,s,t,n);if(!(r&ri)){var b=m&&K.call(e,"__wrapped__"),h=w&&K.call(i,"__wrapped__");if(b||h){var E=b?e.value():e,j=h?i.value():i;return n||(n=new q),t(E,j,r,s,n)}}return u?(n||(n=new q),ii(e,i,r,s,t,n)):!1}var ti=ni;function X(e,i,r,s,t){return e===i?!0:e==null||i==null||!pe(e)&&!pe(i)?e!==e&&i!==i:ti(e,i,r,s,X,t)}var si=X;function ai(e,i){return si(e,i)}var Q=ai;z=te("volume",()=>{let e=se(),i=ae(),r=ne({entries:[]}),s=ne({entries:[]}),t=x(null),n=$i("windpress.dashboard.store.volume.activeViewEntryRelativePath",null);function d(l){return l=l.replace(/[^a-zA-Z0-9._/-]+/g,""),l=l.replace(/\.{2,}/g,"."),l=l.replace(/\/{2,}/g,"/"),l=l.replace(/^[._/ -]+|[._/ -]+$/g,""),l}function a(l){let f=l.split("/").map(d).join("/");f=d(f);let v=r.entries.findIndex(y=>y.relative_path===f);if(v!==-1){if(r.entries[v].hidden===!1)throw Error(wp.i18n.__(`A file named "${f}" already exists`,"windpress"));r.entries[v].hidden=!1,r.entries[v].content=`/* file: ${f} */

`}else r.entries.push({name:f.split("/").pop()||"",content:`/* file: ${f} */

`,relative_path:`${f}`,handler:"internal"});t.value=`${f}`}function o(l){let f=r.entries.findIndex(v=>v.relative_path===l.relative_path);r.entries[f].content="",r.entries[f].hidden=!0,t.value===l.relative_path&&(t.value=null)}function c(l,f){let v=r.entries.findIndex(S=>S.relative_path===l.relative_path),y=f.split("/").map(d).join("/");y=d(y);let k=r.entries.findIndex(S=>S.relative_path===y);if(k!==-1){if(r.entries[k].hidden===!1)throw Error(wp.i18n.__(`A file named "${y}" already exists`,"windpress"));r.entries[k].hidden=!1,r.entries[k].content=r.entries[v].content,r.entries[k].signature&&delete r.entries[k].signature}else{let S=oe(r.entries[v]);S.relative_path=y,S.name=y.split("/").pop()||"",S.content=r.entries[v].content,S.hidden=!1,S.signature=void 0,r.entries.push(S)}o(l)}function m(l){let f=r.entries.findIndex(v=>v.relative_path===l.relative_path);r.entries[f].content=""}function w(){return r.entries.reduce((l,f)=>(l[`/${f.relative_path}`]=f.content,l),{})}async function u(){return i.add("volume.doPull"),await e.request("/admin/volume/index",{method:"GET"}).then(l=>l.data).then(l=>{r.entries=l.entries,h()}).catch(l=>{}).finally(()=>{i.remove("volume.doPull")})}async function b(){return i.add("volume.doPush"),e.request("/admin/volume/store",{method:"POST",data:{volume:{entries:r.entries}}}).then(l=>(h(),{message:l.data.message,success:!0})).catch(l=>{throw Error(l.response?l.response.data.message:l.message)}).finally(()=>{i.remove("volume.doPush")})}W(t,l=>{n.value=l});function h(){r.entries.length!==0&&(t.value=r.entries.some(l=>l.relative_path===n.value)?n.value:"main.css",E.value&&(s.entries=oe(r.entries)))}let E=Ni(()=>!Q(r.entries,s.entries));function j(l){let f=r.entries.find(y=>y.relative_path===l),v=s.entries.find(y=>y.relative_path===l);return!Q(f,v)}async function O(){return r.entries.length===0?u():Promise.resolve()}return{data:r,initData:s,activeViewEntryRelativePath:t,hasChanged:E,addNewEntry:a,getKVEntries:w,doPull:u,doPush:b,entryHasChanged:j,softDeleteEntry:o,resetEntry:m,renameEntry:c,cleanPath:d,initPull:O}}),H=te("themeJson",()=>{let e=se(),i=ae(),r=x({});async function s(){return i.add("themeJson.doPush"),e.request("/admin/theme-json/store",{method:"POST",data:{data:btoa(JSON.stringify(r.value,null,window.windpress.is_debug?2:void 0))}}).then(t=>({message:t.data.message,success:!0})).catch(t=>{throw Error(t.response?t.response.data.message:t.message)}).finally(()=>{i.remove("themeJson.doPush")})}return{themeJson:r,doPush:s}});var li=U(Ki()),oi={class:"flex"},di=["innerHTML"],ci={class:"flex gap-2"},ee=Y({__name:"ConfirmFileActionModal",props:{filePath:{},fileContent:{},actionYes:{},actionNo:{}},emits:["close"],setup(e,{emit:i}){let r=e,s=Ui(),t=x(null);(async()=>t.value=await Qi({themes:[D(()=>import("./dark-plus-DUxK4Phe.min.js").then(async a=>(await a.__tla,a)),[],import.meta.url),D(()=>import("./light-plus-D1Qkc2mD.min.js").then(async a=>(await a.__tla,a)),[],import.meta.url)],langs:[D(()=>import("./css-CZ_P402v.min.js").then(async a=>(await a.__tla,a)),[],import.meta.url),D(()=>import("./javascript-C1ltarFm.min.js").then(async a=>(await a.__tla,a)),[],import.meta.url)],engine:er(D(()=>import("./wasm-AKcBxSw7.min.js").then(async a=>(await a.__tla,a)),[],import.meta.url))}))();let n=Mi(async()=>{if(!r.fileContent||!t.value)return;let a=li.default.extname(r.filePath).replace(".","");return t.value.codeToHtml(r.fileContent,{lang:a==="css"?"css":"javascript",theme:s.value==="dark"?"dark-plus":"light-plus"})}),d=i;return(a,o)=>{let c=N,m=$;return T(),I(m,{close:{onClick:()=>d("close",!1)}},Ri({title:g(()=>[V(P(a.i18n.sprintf(a.i18n.__('Are you sure you want to %s the "%s" file?',"windpress"),e.actionYes,e.filePath)),1)]),footer:g(()=>[p("div",ci,[F(c,{color:"neutral",variant:"soft",label:a.i18n.__("cancel","windpress"),onClick:o[0]||(o[0]=w=>d("close",!1)),class:"capitalize"},null,8,["label"]),F(c,{color:"error",variant:"soft",label:e.actionYes,onClick:o[1]||(o[1]=w=>d("close",!0)),class:"capitalize"},null,8,["label"])])]),_:2},[e.fileContent?{name:"body",fn:g(()=>[(T(),I(Yi,null,{default:g(()=>[p("div",oi,[p("div",{innerHTML:re(n),class:"flex [&>pre]:p-4 [&>pre]:mr-6"},null,8,di)])]),_:1}))]),key:"0"}:void 0]),1032,["close"])}}}),pi=U(ve()),ui={class:"flex flex-col gap-4 text-(--ui-text)"},_i={class:"font-bold uppercase my-2"},fi={class:"w-full"},wi={class:"font-semibold w-1/3"},mi={class:""},vi={class:"font-semibold w-1/5"},hi={class:""},yi={class:"font-semibold w-1/5"},bi={class:""},gi={class:"font-semibold w-1/5"},Ei={class:""},Pi={class:"flex gap-2"},Fi=Y({__name:"ConfirmVolumeImportModal",props:{data:{}},emits:["close"],setup(e,{emit:i}){let r=e,s=i;return(t,n)=>{let d=N,a=$;return T(),I(a,{close:{onClick:()=>s("close",!1)}},{title:g(()=>[V(P(t.i18n.__("Import SFS volume","windpress")),1)]),body:g(()=>[p("div",ui,[p("div",null,[p("div",_i,P(t.i18n.__("File info","windpress")),1),p("table",fi,[p("tbody",null,[p("tr",null,[p("td",wi,P(t.i18n.__("WindPress version","windpress")),1),n[2]||(n[2]=p("td",{class:""},":",-1)),p("td",mi,P(r.data._version),1)]),p("tr",null,[p("td",vi,P(t.i18n.__("WP Version","windpress")),1),n[3]||(n[3]=p("td",{class:""},":",-1)),p("td",hi,P(r.data._wp_version),1)]),p("tr",null,[p("td",yi,P(t.i18n.__("Exported on","windpress")),1),n[4]||(n[4]=p("td",{class:""},":",-1)),p("td",bi,P(re(pi.default)(r.data._timestamp).format("YYYY-MM-DD HH:mm:ss")),1)]),p("tr",null,[p("td",gi,P(t.i18n.__("Entries","windpress")),1),n[5]||(n[5]=p("td",{class:""},":",-1)),p("td",Ei,P(r.data.entries.length),1)])])])]),V(" "+P(t.i18n.__("This will overwrite all existing files. Are you sure you want to continue?","windpress")),1)])]),footer:g(()=>[p("div",Pi,[F(d,{color:"neutral",variant:"soft",label:t.i18n.__("cancel","windpress"),onClick:n[0]||(n[0]=o=>s("close",!1)),class:"capitalize"},null,8,["label"]),F(d,{color:"warning",variant:"soft",label:t.i18n.__("Yes, continue","windpress"),onClick:n[1]||(n[1]=o=>s("close",!0)),class:"capitalize"},null,8,["label"])])]),_:1},8,["close"])}}}),Si={class:"flex gap-2"},Ci=Y({__name:"NewFileFormModal",emits:["close"],setup(e,{emit:i}){let r=z(),s=i,t=x(""),n=x(!1);W(()=>t.value,()=>{n.value=!1});function d(){if(n.value=!1,!t.value){n.value=wp.i18n.__("Filename is required","windpress");return}if(!t.value.endsWith(".css")&&!t.value.endsWith(".js")){n.value=wp.i18n.__("File extension must be .css or .js","windpress");return}if(!/^[a-zA-Z0-9_.\-\/]+$/.test(t.value)){n.value=wp.i18n.__("Only alphanumeric, dash, underscore, forward slash, and dot are allowed","windpress");return}if(r.data.entries.find(a=>a.relative_path===`${t.value}`&&a.hidden!==!0)){n.value=wp.i18n.sprintf(wp.i18n.__('A file named "%s" already exists',"windpress"),t.value);return}s("close",t.value)}return(a,o)=>{let c=we,m=he,w=N,u=$;return T(),I(u,{close:{onClick:()=>s("close")}},{title:g(()=>[V(P(a.i18n.__("Create New File","windpress")),1)]),body:g(()=>[F(m,{label:"Filename",required:"",description:a.i18n.__("Filename may include a path. (css or js)","windpress"),error:n.value},{default:g(()=>[F(c,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=b=>t.value=b),placeholder:"theme/color.css",class:"w-full"},null,8,["modelValue"])]),_:1},8,["description","error"])]),footer:g(()=>[p("div",Si,[F(w,{color:"neutral",variant:"soft",label:a.i18n.__("cancel","windpress"),onClick:o[1]||(o[1]=b=>s("close")),class:"capitalize"},null,8,["label"]),F(w,{color:"primary",variant:"soft",label:a.i18n.__("Submit","windpress"),onClick:d,class:"capitalize"},null,8,["label"])])]),_:1},8,["close"])}}}),ji={class:"flex gap-2"},Oi=Y({__name:"RenameFileFormModal",props:{filePath:{}},emits:["close"],setup(e,{emit:i}){let r=z(),s=i,t=e,n=x(t.filePath),d=x(!1);W(()=>n.value,()=>{d.value=!1});function a(){if(d.value=!1,!n.value){d.value=wp.i18n.__("Filename is required","windpress");return}if(!n.value.endsWith(".css")&&!n.value.endsWith(".js")){d.value=wp.i18n.__("File extension must be .css or .js","windpress");return}if(!/^[a-zA-Z0-9_.\-\/]+$/.test(n.value)){d.value=wp.i18n.__("Only alphanumeric, dash, underscore, forward slash, and dot are allowed","windpress");return}if(r.data.entries.find(o=>o.relative_path===`${n.value}`&&o.hidden!==!0)){d.value=wp.i18n.sprintf(wp.i18n.__('A file named "%s" already exists',"windpress"),n.value);return}s("close",n.value)}return(o,c)=>{let m=we,w=he,u=N,b=$;return T(),I(b,{close:{onClick:()=>s("close")}},{title:g(()=>[V(P(o.i18n.__("Rename File","windpress")),1)]),body:g(()=>[F(w,{label:"Old Filename",description:o.i18n.__("The previous filename","windpress"),class:"mb-2"},{default:g(()=>[F(m,{value:t.filePath,disabled:!0,class:"w-full"},null,8,["value"])]),_:1},8,["description"]),F(w,{label:"New Filename",required:"",description:o.i18n.__("Filename may include a path. (css or js)","windpress"),error:d.value},{default:g(()=>[F(m,{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=h=>n.value=h),placeholder:"theme/color.css",class:"w-full"},null,8,["modelValue"])]),_:1},8,["description","error"])]),footer:g(()=>[p("div",ji,[F(u,{color:"neutral",variant:"soft",label:o.i18n.__("cancel","windpress"),onClick:c[1]||(c[1]=h=>s("close")),class:"capitalize"},null,8,["label"]),F(u,{color:"primary",variant:"soft",label:o.i18n.__("Submit","windpress"),onClick:a,class:"capitalize"},null,8,["label"])])]),_:1},8,["close"])}}}),xi=U(ve()),C=z(),ki=Ji(),Ai=H(),_=qi(),A=Wi();async function Vi(e){if(e.readonly){_.add({title:wp.i18n.__("Error","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" is read-only and not deletable',"windpress"),e.relative_path),color:"error",icon:"i-lucide-trash"});return}if(e.relative_path==="main.css"){_.add({title:wp.i18n.__("Error","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" is required for the WindPress to work and not deletable',"windpress"),e.relative_path),color:"error",icon:"i-lucide-trash"});return}if(!await A.create(ee,{destroyOnClose:!0,props:{filePath:e.relative_path,fileContent:e.content,actionYes:wp.i18n.__("delete","windpress")}}).open().result){_.add({title:wp.i18n.__("Canceled","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" is not deleted',"windpress"),e.relative_path),color:"info",icon:"i-lucide-trash"});return}C.softDeleteEntry(e),_.add({title:wp.i18n.__("Success","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" deleted',"windpress"),e.relative_path),color:"success",icon:"i-lucide-trash"})}async function Ii(e){if(!await A.create(ee,{destroyOnClose:!0,props:{filePath:e.relative_path,fileContent:e.content,actionYes:wp.i18n.__("reset","windpress")}}).open().result){_.add({title:wp.i18n.__("Canceled","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" is not reset',"windpress"),e.relative_path),color:"info",icon:"lucide:file-minus-2"});return}C.resetEntry(e),_.add({title:wp.i18n.__("Success","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" reset',"windpress"),e.relative_path),color:"success",icon:"lucide:file-minus-2"}),ie().then(()=>{C.doPull()})}async function ie(){let e={title:wp.i18n.__("Saving...","windpress"),description:wp.i18n.__("Please wait while we save your changes.","windpress"),duration:0,icon:"lucide:loader-circle",close:!1,color:"neutral",ui:{icon:"animate-spin"}};return _.toasts.value.find(i=>i.id==="file-editor.doSave")?_.update("file-editor.doSave",{...e}):_.add({id:"file-editor.doSave",...e}),C.doPush().then(()=>{_.update("file-editor.doSave",{title:wp.i18n.__("Saved","windpress"),description:wp.i18n.__("Your changes have been saved.","windpress"),icon:"i-lucide-save",color:"success",duration:void 0,close:!0,ui:{icon:void 0}}),Number(ki.virtualOptions("general.tailwindcss.version",4).value)===4&&Ai.doPush()}).catch(i=>{_.update("file-editor.doSave",{title:wp.i18n.__("Error","windpress"),description:wp.i18n.__("An error occurred while saving your changes.","windpress"),icon:"i-lucide-save",color:"error",duration:void 0,close:!0,ui:{icon:void 0}})}).finally(()=>{let i=new BroadcastChannel("windpress");["windpress/observer","windpress/intellisense"].forEach(r=>{i.postMessage({source:"windpress/dashboard",target:r,task:"windpress.code-editor.saved",payload:{volume:Xi(C.getKVEntries())}})}),i.close()})}function Ti(){let e={entries:C.data.entries,_windpress:!0,_version:window.windpress._version,_wp_version:window.windpress._wp_version,_timestamp:new Date().getTime(),_uid:Hi(),_type:"sfs"},i=me.compressToUint8Array(JSON.stringify(e)),r=new Blob([i],{type:"application/octet-stream"}),s=URL.createObjectURL(r),t=document.createElement("a");t.href=s,t.download=`sfs-${(0,xi.default)().format("YYYYMMDDHHmmss")}.windpress`,t.click(),URL.revokeObjectURL(s),_.add({title:wp.i18n.__("Exported","windpress"),description:wp.i18n.__("SFS volume data exported","windpress"),color:"success",icon:"i-lucide-download"})}async function Di(e){let i=e.target;if(!i||!i.files||i.files.length===0)return;let r=i.files[0];if(!r)return;if(!r.name.endsWith(".windpress")){_.add({title:wp.i18n.__("SFS Import","windpress"),description:wp.i18n.__("Invalid file format","windpress"),color:"error",icon:"i-lucide-upload"});return}let s;try{if(s=JSON.parse(me.decompressFromUint8Array(new Uint8Array(await r.arrayBuffer()))||"{}"),!s._windpress||s._type!=="sfs")throw Error(wp.i18n.__("File is not a valid WindPress file","windpress"))}catch(t){_.add({title:wp.i18n.__("SFS Import","windpress"),description:t instanceof Error?t.message:wp.i18n.__("An unknown error occurred","windpress"),color:"error",icon:"i-lucide-upload"});return}if(!await A.create(Fi,{destroyOnClose:!0,props:{data:s}}).open().result){_.add({title:wp.i18n.__("Canceled","windpress"),description:wp.i18n.__("SFS import canceled","windpress"),color:"info",icon:"i-lucide-upload"}),i.value="";return}_.add({id:"file-import.doImport",title:wp.i18n.__("Importing...","windpress"),description:wp.i18n.__("Please wait while we import the data.","windpress"),icon:"lucide:loader-circle",close:!1,duration:0,color:"neutral",ui:{icon:"animate-spin"}}),await new Promise(t=>setTimeout(t,500));try{let t=s.entries.map(n=>{if(n.signature&&n.handler==="internal"){let{signature:d,...a}=n;return a}return n});C.data.entries=t,_.update("file-import.doImport",{title:wp.i18n.__("Success","windpress"),description:wp.i18n.__("SFS data imported. Remember to save the changes.","windpress"),color:"success",icon:"i-lucide-upload",duration:void 0,close:!0,ui:{icon:void 0}}),i.value=""}catch(t){_.update("file-import.doImport",{title:wp.i18n.__("Error","windpress"),description:t instanceof Error?t.message:wp.i18n.__("An unknown error occurred","windpress"),color:"error",icon:"i-lucide-upload",close:!0,duration:void 0,ui:{icon:void 0}}),i.value=""}}async function zi(){let e=await A.create(Ci,{destroyOnClose:!0}).open().result;if(!e){_.add({title:wp.i18n.__("Canceled","windpress"),description:wp.i18n.__("New file creation canceled","windpress"),color:"info",icon:"i-lucide-plus"});return}try{C.addNewEntry(e),_.add({title:wp.i18n.__("Success","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" created',"windpress"),e),color:"success",icon:"i-lucide-plus"})}catch(i){_.add({title:wp.i18n.__("Error","windpress"),description:i instanceof Error?i.message:wp.i18n.__("An unknown error occurred","windpress"),color:"error",icon:"i-lucide-plus"})}}async function Li(e){let i=await A.create(Oi,{destroyOnClose:!0,props:{filePath:e.relative_path}}).open().result;if(!i){_.add({title:wp.i18n.__("Canceled","windpress"),description:wp.i18n.__("File rename canceled","windpress"),color:"info",icon:"i-lucide-edit"});return}try{C.renameEntry(e,i),_.add({title:wp.i18n.__("Success","windpress"),description:wp.i18n.sprintf(wp.i18n.__('File "%s" renamed to "%s"',"windpress"),e.relative_path,i),color:"success",icon:"i-lucide-edit"})}catch(r){_.add({title:wp.i18n.__("Error","windpress"),description:r instanceof Error?r.message:wp.i18n.__("An unknown error occurred","windpress"),color:"error",icon:"i-lucide-edit"})}}ye=function(){return{deleteFile:Vi,resetFile:Ii,save:ie,exportVolume:Ti,importVolume:Di,addNewFile:zi,renameFile:Li}}})();export{ir as __tla,H as n,z as r,ye as t};
