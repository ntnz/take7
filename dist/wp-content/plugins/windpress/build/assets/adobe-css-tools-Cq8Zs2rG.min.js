var R=Object.defineProperty;var q=(t,s,l)=>s in t?R(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l;var $=(t,s,l)=>q(t,typeof s!="symbol"?s+"":s,l);var B=class extends Error{constructor(s,l,m,h,d){super(`${s}:${m}:${h}: ${l}`);$(this,"reason");$(this,"filename");$(this,"line");$(this,"column");$(this,"source");this.reason=l,this.filename=s,this.line=m,this.column=h,this.source=d}},G=class{constructor(t,s,l){$(this,"start");$(this,"end");$(this,"source");this.start=t,this.end=s,this.source=l}},o;(function(t){t.stylesheet="stylesheet",t.rule="rule",t.declaration="declaration",t.comment="comment",t.container="container",t.charset="charset",t.document="document",t.customMedia="custom-media",t.fontFace="font-face",t.host="host",t.import="import",t.keyframes="keyframes",t.keyframe="keyframe",t.layer="layer",t.media="media",t.namespace="namespace",t.page="page",t.startingStyle="starting-style",t.supports="supports"})(o||(o={}));var T=(t,s,l)=>{let m=l,h=1e4;do{let d=s.map(c=>t.indexOf(c,m));d.push(t.indexOf("\\",m));let a=d.filter(c=>c!==-1);if(a.length===0)return-1;let f=Math.min(...a);if(t[f]!=="\\")return f;m=f+2,h--}while(h>0);throw Error("Too many escaping")},b=(t,s,l)=>{let m=l,h=1e4;do{let d=s.map(c=>t.indexOf(c,m));d.push(t.indexOf("(",m)),d.push(t.indexOf('"',m)),d.push(t.indexOf("'",m)),d.push(t.indexOf("\\",m));let a=d.filter(c=>c!==-1);if(a.length===0)return-1;let f=Math.min(...a);switch(t[f]){case"\\":m=f+2;break;case"(":{let c=b(t,[")"],f+1);if(c===-1)return-1;m=c+1}break;case'"':{let c=T(t,['"'],f+1);if(c===-1)return-1;m=c+1}break;case"'":{let c=T(t,["'"],f+1);if(c===-1)return-1;m=c+1}break;default:return f}h--}while(h>0);throw Error("Too many escaping")},j=/\/\*[^]*?(?:\*\/|$)/g;function x(t){return t?t.trim():""}function O(t,s){let l=t&&typeof t.type=="string",m=l?t:s;for(let h in t){let d=t[h];Array.isArray(d)?d.forEach(a=>{O(a,m)}):d&&typeof d=="object"&&O(d,m)}return l&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:s||null}),t}var H=class{constructor(t){$(this,"level",0);$(this,"indentation","  ");$(this,"compress",!1);typeof(t==null?void 0:t.indent)=="string"&&(this.indentation=t==null?void 0:t.indent),t!=null&&t.compress&&(this.compress=!0)}emit(t,s){return t}indent(t){return this.level=this.level||1,t?(this.level+=t,""):Array(this.level).join(this.indentation)}visit(t){switch(t.type){case o.stylesheet:return this.stylesheet(t);case o.rule:return this.rule(t);case o.declaration:return this.declaration(t);case o.comment:return this.comment(t);case o.container:return this.container(t);case o.charset:return this.charset(t);case o.document:return this.document(t);case o.customMedia:return this.customMedia(t);case o.fontFace:return this.fontFace(t);case o.host:return this.host(t);case o.import:return this.import(t);case o.keyframes:return this.keyframes(t);case o.keyframe:return this.keyframe(t);case o.layer:return this.layer(t);case o.media:return this.media(t);case o.namespace:return this.namespace(t);case o.page:return this.page(t);case o.startingStyle:return this.startingStyle(t);case o.supports:return this.supports(t)}}mapVisit(t,s){let l="";s||(s="");for(let m=0,h=t.length;m<h;m++)l+=this.visit(t[m]),s&&m<h-1&&(l+=this.emit(s));return l}compile(t){return this.compress?t.stylesheet.rules.map(this.visit,this).join(""):this.stylesheet(t)}stylesheet(t){return this.mapVisit(t.stylesheet.rules,`

`)}comment(t){return this.compress?this.emit("",t.position):this.emit(`${this.indent()}/*${t.comment}*/`,t.position)}container(t){return this.compress?this.emit(`@container ${t.container}`,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@container ${t.container}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}layer(t){return this.compress?this.emit(`@layer ${t.layer}`,t.position)+(t.rules?this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):";"):this.emit(`${this.indent()}@layer ${t.layer}`,t.position)+(t.rules?this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`):";")}import(t){return this.emit(`@import ${t.import};`,t.position)}media(t){return this.compress?this.emit(`@media ${t.media}`,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@media ${t.media}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}document(t){let s=`@${t.vendor||""}document ${t.document}`;return this.compress?this.emit(s,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(s,t.position)+this.emit(`  {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`${this.indent(-1)}
}`)}charset(t){return this.emit(`@charset ${t.charset};`,t.position)}namespace(t){return this.emit(`@namespace ${t.namespace};`,t.position)}startingStyle(t){return this.compress?this.emit("@starting-style",t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@starting-style`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}supports(t){return this.compress?this.emit(`@supports ${t.supports}`,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@supports ${t.supports}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}keyframes(t){return this.compress?this.emit(`@${t.vendor||""}keyframes ${t.name}`,t.position)+this.emit("{")+this.mapVisit(t.keyframes)+this.emit("}"):this.emit(`@${t.vendor||""}keyframes ${t.name}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.keyframes,`
`)+this.emit(`${this.indent(-1)}}`)}keyframe(t){let s=t.declarations;return this.compress?this.emit(t.values.join(","),t.position)+this.emit("{")+this.mapVisit(s)+this.emit("}"):this.emit(this.indent())+this.emit(t.values.join(", "),t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(s,`
`)+this.emit(`${this.indent(-1)}
${this.indent()}}
`)}page(t){if(this.compress){let l=t.selectors.length?t.selectors.join(", "):"";return this.emit(`@page ${l}`,t.position)+this.emit("{")+this.mapVisit(t.declarations)+this.emit("}")}let s=t.selectors.length?`${t.selectors.join(", ")} `:"";return this.emit(`@page ${s}`,t.position)+this.emit(`{
`)+this.emit(this.indent(1))+this.mapVisit(t.declarations,`
`)+this.emit(this.indent(-1))+this.emit(`
}`)}fontFace(t){return this.compress?this.emit("@font-face",t.position)+this.emit("{")+this.mapVisit(t.declarations)+this.emit("}"):this.emit("@font-face ",t.position)+this.emit(`{
`)+this.emit(this.indent(1))+this.mapVisit(t.declarations,`
`)+this.emit(this.indent(-1))+this.emit(`
}`)}host(t){return this.compress?this.emit("@host",t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit("@host",t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`${this.indent(-1)}
}`)}customMedia(t){return this.emit(`@custom-media ${t.name} ${t.media};`,t.position)}rule(t){let s=t.declarations;if(!s.length)return"";if(this.compress)return this.emit(t.selectors.join(","),t.position)+this.emit("{")+this.mapVisit(s)+this.emit("}");let l=this.indent();return this.emit(t.selectors.map(m=>l+m).join(`,
`),t.position)+this.emit(` {
`)+this.emit(this.indent(1))+this.mapVisit(s,`
`)+this.emit(this.indent(-1))+this.emit(`
${this.indent()}}`)}declaration(t){return this.compress?this.emit(`${t.property}:${t.value}`,t.position)+this.emit(";"):t.property==="grid-template-areas"?this.emit(this.indent())+this.emit(t.property+": "+t.value.split(`
`).join(`
`.padEnd(22)+this.indent()),t.position)+this.emit(";"):this.emit(this.indent())+this.emit(`${t.property}: ${t.value}`,t.position)+this.emit(";")}},J=(t,s)=>{s||(s={});let l=1,m=1;function h(){let e={line:l,column:m};return i=>(i.position=new G(e,{line:l,column:m},(s==null?void 0:s.source)||""),E(),i)}let d=[];function a(e){let i=new B((s==null?void 0:s.source)||"",e,l,m,t);if(!(s!=null&&s.silent))throw i;d.push(i)}function f(){let e=/^{\s*/.exec(t);return!!e&&(p(e),!0)}function c(){let e=/^}/.exec(t);return!!e&&(p(e),!0)}function k(){let e,i=[];for(E(),y(i);t.length&&t.charAt(0)!=="}"&&(e=I()||P(),e);)i.push(e),y(i);return i}function p(e){let i=e[0];return(function(n){let r=n.match(/\n/g);r&&(l+=r.length);let u=n.lastIndexOf(`
`);m=~u?n.length-u:m+n.length})(i),t=t.slice(i.length),e}function E(){let e=/^\s*/.exec(t);e&&p(e)}function y(e){e||(e=[]);let i=A();for(;i;)e.push(i),i=A();return e}function A(){let e=h();if(t.charAt(0)!=="/"||t.charAt(1)!=="*")return;let i=/^\/\*[^]*?\*\//.exec(t);return i?(p(i),e({type:o.comment,comment:i[0].slice(2,-2)})):a("End of comment missing")}function M(){let e=/^([^{]+)/.exec(t);if(e)return p(e),((i,n)=>{let r=[],u=0;for(;u<i.length;){let g=b(i,n,u);if(g===-1)return r.push(i.substring(u)),r;r.push(i.substring(u,g)),u=g+1}return r})(x(e[0]).replace(j,""),[","]).map(i=>x(i))}function V(){let e=h(),i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/.exec(t);if(!i)return;p(i);let n=x(i[0]),r=/^:\s*/.exec(t);if(!r)return a("property missing ':'");p(r);let u="",g=b(t,[";","}"]);g!==-1&&(u=t.substring(0,g),p([u]),u=x(u).replace(j,""));let v=e({type:o.declaration,property:n.replace(j,""),value:u}),z=/^[;\s]*/.exec(t);return z&&p(z),v}function S(){let e=[];if(!f())return a("missing '{'");y(e);let i=V();for(;i;)e.push(i),y(e),i=V();return c()?e:a("missing '}'")}function F(){let e=[],i=h(),n=/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/.exec(t);for(;n;){let r=p(n);e.push(r[1]);let u=/^,\s*/.exec(t);u&&p(u),n=/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/.exec(t)}if(e.length)return i({type:o.keyframe,values:e,declarations:S()||[]})}let _=w("import"),C=w("charset"),D=w("namespace");function w(e){let i=RegExp("^@"+e+`\\s*((?::?[^;'"]|"(?:\\\\"|[^"])*?"|'(?:\\\\'|[^'])*?')+)(?:;|$)`);return()=>{let n=h(),r=i.exec(t);if(!r)return;let u=p(r),g={type:e};return g[e]=u[1].trim(),n(g)}}function I(){if(t[0]==="@")return(function(){let e=h(),i=/^@([-\w]+)?keyframes\s*/.exec(t);if(!i)return;let n=p(i)[1],r=/^([-\w]+)\s*/.exec(t);if(!r)return a("@keyframes missing name");let u=p(r)[1];if(!f())return a("@keyframes missing '{'");let g=y(),v=F();for(;v;)g.push(v),g=g.concat(y()),v=F();return c()?e({type:o.keyframes,name:u,vendor:n,keyframes:g}):a("@keyframes missing '}'")})()||(function(){let e=h(),i=/^@media *([^{]+)/.exec(t);if(!i)return;let n=x(p(i)[1]);if(!f())return a("@media missing '{'");let r=y().concat(k());return c()?e({type:o.media,media:n,rules:r}):a("@media missing '}'")})()||(function(){let e=h(),i=/^@custom-media\s+(--\S+)\s+([^{;\s][^{;]*);/.exec(t);if(!i)return;let n=p(i);return e({type:o.customMedia,name:x(n[1]),media:x(n[2])})})()||(function(){let e=h(),i=/^@supports *([^{]+)/.exec(t);if(!i)return;let n=x(p(i)[1]);if(!f())return a("@supports missing '{'");let r=y().concat(k());return c()?e({type:o.supports,supports:n,rules:r}):a("@supports missing '}'")})()||_()||C()||D()||(function(){let e=h(),i=/^@([-\w]+)?document *([^{]+)/.exec(t);if(!i)return;let n=p(i),r=x(n[1]),u=x(n[2]);if(!f())return a("@document missing '{'");let g=y().concat(k());return c()?e({type:o.document,document:u,vendor:r,rules:g}):a("@document missing '}'")})()||(function(){let e=h(),i=/^@page */.exec(t);if(!i)return;p(i);let n=M()||[];if(!f())return a("@page missing '{'");let r=y(),u=V();for(;u;)r.push(u),r=r.concat(y()),u=V();return c()?e({type:o.page,selectors:n,declarations:r}):a("@page missing '}'")})()||(function(){let e=h(),i=/^@host\s*/.exec(t);if(!i)return;if(p(i),!f())return a("@host missing '{'");let n=y().concat(k());return c()?e({type:o.host,rules:n}):a("@host missing '}'")})()||(function(){let e=h(),i=/^@font-face\s*/.exec(t);if(!i)return;if(p(i),!f())return a("@font-face missing '{'");let n=y(),r=V();for(;r;)n.push(r),n=n.concat(y()),r=V();return c()?e({type:o.fontFace,declarations:n}):a("@font-face missing '}'")})()||(function(){let e=h(),i=/^@container *([^{]+)/.exec(t);if(!i)return;let n=x(p(i)[1]);if(!f())return a("@container missing '{'");let r=y().concat(k());return c()?e({type:o.container,container:n,rules:r}):a("@container missing '}'")})()||(function(){let e=h(),i=/^@starting-style\s*/.exec(t);if(!i)return;if(p(i),!f())return a("@starting-style missing '{'");let n=y().concat(k());return c()?e({type:o.startingStyle,rules:n}):a("@starting-style missing '}'")})()||(function(){let e=h(),i=/^@layer *([^{;@]+)/.exec(t);if(!i)return;let n=x(p(i)[1]);if(!f()){let u=/^[;\s]*/.exec(t);return u&&p(u),e({type:o.layer,layer:n})}let r=y().concat(k());return c()?e({type:o.layer,layer:n,rules:r}):a("@layer missing '}'")})()}function P(){let e=h(),i=M();return i?(y(),e({type:o.rule,selectors:i,declarations:S()||[]})):a("selector missing")}return O((function(){let e=k();return{type:o.stylesheet,stylesheet:{source:s==null?void 0:s.source,rules:e,parsingErrors:d}}})())},K=(t,s)=>new H(s||{}).compile(t);export{J as n,K as t};
